import requests
import json

def lambda_handler(event, context):
    identity_url = "http://169.254.169.254/latest/dynamic/instance-identity/document"
    identity = json.loads(requests.get(identity_url).text)
    account_id = identity["accountId"]
    region = identity["region"]
    instance_id = identity["instanceId"]
    
    role_name = None
    user_name = None
    
    # Get the ARN of the execution role
    execution_role_arn = context.invoked_function_arn.split(":")
    role_name = execution_role_arn[-1].split("/")[-1]
    
    if not role_name:
        # If the Lambda function is not running under an IAM role, check if it's running under an IAM user
        user_name = execution_role_arn[-2]
    
    if role_name:
        print(f"The Lambda function is running under IAM role: {role_name}")
    elif user_name:
        print(f"The Lambda function is running under IAM user: {user_name}")
    else:
        print("Unable to determine IAM user or role name")
    
    # Your function logic goes here...
